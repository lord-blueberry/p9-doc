\section{Introduction}
In Astronomy, instruments with higher angular resolution allows us to measure ever smaller structures in the sky. For Radio frequencies, the angular resolution is bound to the antenna dish diameter, which puts practical and financial limitations on the highest possible angular resolution. Radio Interferometers get around this limitation by using several smaller antennas instead. Together, they act as a single large antenna with higher angular resolution at lower financial costs compared to single dish instruments.

New Radio Interferometers are built
Higher sensitivity
Create images at a hIgher angular resolution
Like MeerKAT
Does not measure the sky image
Difficulty creating an image

And interferometers do not measure the sky directly. Interferometers do not measure the sky in pixels. Each antenna pair measures a Fourier Component. 
But the image reconstruction forms an ill-posed inverse problem
We have many possible images that fit the measurements.
Image reconstruction has to find the most likely image.

But produce a huge amount of data.
larger problem size require distributed computing
so far, it was difficult to separate the image reconstruction
Too much work was multiplied by the number of nodes.
Mostly done on a limited number of shared-memory systems

Target to distribute the image reconstruction
First tests


\subsection{Radio Interferometry System}
The figure \ref{intro:system} shows the whole imaging pipeline for an interferometer, which consists of three steps: Correlator, Calibration and Image Reconstruction. The incoming electromagnetic wave gets measured by the different antennas of the interferometer. The measurements of each antenna pair get correlated into a complex-valued Fourier Component (called Visibility in Radio Astronomy). Each antenna pair therefore measures amplitude and phase of a single Visibility (Fourier Component) of the sky image.
What Visibility is measured depends on the distance of the antenna pairs, called the baseline. The longer the baseline, the higher-order Visibility gets measured. Meaning more angular resolution.

\begin{figure}[h]
	\centering
	\includegraphics[width=0.80\linewidth]{./chapters/01.intro/system.png}
	\caption{Interferometer System}
	\label{intro:system}
\end{figure}

What Visibilities get measured depends on the antenna layout. The earth rotation modifies the baselines. Due to the earth's rotation, we can sample different Visibilities. (filling the aperture).
Noisy measurements
Only a limited number of Visibilities. This is where the incompleteness comes in. We do not have enough data.
After the Correlator, this is what is saved as the raw measurements.

In the Calibration step, we correct for (Interferometer stuff), Pointing errors, Calibrate the amplitude and phase of the visibilities. Correct for pointing errors. (The interferometer measures relative values). Flagging, remove hopelessly noisy data.
Done before imaging, manual labour.

The last step, the Image Reconstruction is where this work focuses its attention. This is where the ill-posed inverse problem is. We want to find the image corresponding to the calibrated visibilities. 
[Improving the Calibration with partial results of the image reconstruction, done in practice but not part of this project.]
The Image Reconstruction part is where the ill-posed inverse problem arises.


\subsection{Image Reconstruction Problem}
We want to find the image $I()$ which fits the calibrated Visibilities $V()$. The relationship between the Image and the Visibilities is shown in equation \eqref{intro:inverseproblem}.

\begin{equation}\label{intro:inverseproblem}
V(u, v, w) = \int\int \frac{1}{c(x, y)} I(x, y) e^{2 \pi i [ux+vy+ w(c(x, y) - 1)]} \: dx \: dy \quad, \quad c(x,y) = \sqrt{1 - x^2 - y ^2}
\end{equation}

[Not Really 2d Relationship. if $c() << 1$ Fourier part $e^{2 \pi i [ux+vy]}$]. This is the Fourier transform, but in our case we have an extra term $w(c(x, y) - 1)$ that keeps us from using the 2d fourier transform, and by extend the 2d FFT.
But still a linear relationship. Meaning we can express the relationship from Visibilities $V()$ and Image $I()$ with a matrix, which we call $F$.
Create a set of linear equations and solve for the image. Different ways of representing the image reconstruction problem.

\begin{alignat}{2}
\text{analysis:}\: \underset{I}{find}&\quad FI = V \quad &\\
\text{in-painting:}\: \underset{V_{Unif}}{find}&\quad MV_{Unif} = V,  \quad &I = iFFT(V_{Unif})\\
\text{deconvolution:}\: \underset{I}{find}&\quad I \star PSF = I_{Dirty},  \quad &I_{Dirty} = F^{-1}V
\end{alignat}

Explain analysis
Explain in-painting
explain deconvolution
All are a way to represent the Image reconstruction problem. If the problem had a unique solution, all three representation would find it. Interestingly enough, in Radio Astronomy, we generally have more Visibilities than Pixels in the reconstruction. the first two (ref) are over-determined problems, meaning we have more linear equations than free variables in the system.
At first glance, it seems like we can solve equation \eqref{intro:linear}.
Why equation \eqref{intro:linear} is ill-posed. Depends on the properties of $V()$
An example from the MeerKAT Radio Interferometer is shown in figure \ref{intro:inversefig}.

\begin{figure}[htp]
	% preliminary
	\sbox\twosubbox{%
		\resizebox{\dimexpr.9\textwidth-1em}{!}{%
			\includegraphics[height=3cm]{./chapters/01.intro/meerkat_uv2.png}%
			\includegraphics[height=3cm]{./chapters/01.intro/mk2/clean.png}%
		}%
	}
	\setlength{\twosubht}{\ht\twosubbox}
	
	% typeset
	\centering
	\subcaptionbox{Measurements $V()$ in the UV plane.\label{intro:inversefig:uvspace}}{%
		\includegraphics[height=\twosubht]{./chapters/01.intro/meerkat_uv2.png}%
	}\quad
	\subcaptionbox{A reconstructed image $I()$ which fits the measurements.\label{intro:inversefig:reconstruction}}{%
		\includegraphics[height=\twosubht]{./chapters/01.intro/mk2/clean.png}%
	}
	\caption{The Image Reconstruction Problem}\label{intro:inversefig}
\end{figure}

In figure \ref{intro:inversefig:uvspace} shows the Visibility Samples in the UV space. We have densely sampled areas, and holes.
We have too much data in some areas, while too little in others. Furthermore each Visibility measurement is noisy. These two properties make that many possible images fit the measurements. Which makes the whole inverse problem ill-posed.
From the measurements alone, we cannot find the observed image from all possible solutions. We need prior information

$F$ is too big for any practical application. It has the size of pixels times Visibilities. 4k*4k pixels, times 4 billion Visibilities. Approximate $F$.
Decide on a representation!

To solve the image reconstruction problem in Radio Astronomy, we need two things.
\begin{itemize}
	\item Decide on a representation.
	\item Prior knowledge about the image.
	\item If needed, a fast approximation of the Matrix $F$
\end{itemize} 


\subsection{Solving the Image Reconstruction Problem: The Major/Minor Cycle architecture}
Current state of the art way of solving the image reconstruction problem. Major Minor Cycle architecture.
Representation: Deconvolution.
The Major Cycle is a fast approximation of the Transform Matrix $F$.
The Minor Cycle is a deconvolution algorithm. In this architecture, the Deconvolution algorithm is responsible for including prior knowledge about the image.

\begin{figure}[h]
	\centering
	\includegraphics[width=0.80\linewidth]{./chapters/02.hypo/Major-Minor3.png}
	\caption{The Major Cycle Architecture}
	\label{intro:major}
\end{figure}

The Gridder + FFT is responsible for a fast approximation of $F$, while the deconvolution algorithm
Gridder is responsible for handling all Radio Interferometry weirdness. It has to handle the $w$-term of the Visibilities \eqref{intro:inverseproblem}. In practice, even more corrections fall onto the job of the Gridder. Since we have magnitudes more Visibilities than pixels, the Gridder's job is to "compress" the problem.

Note on the Cyclic Nature. It is counter intuitive and explained later in 

\subsubsection{The Gridder}


\subsubsection{Minor Cycle: CLEAN Deconvolutions}
Contains two classes of objects: Point sources, which are essentially stars, and extended emissions, which span over several pixels.


\subsubsection{Why are there Major Cycles in the first place?}
\begin{figure}[h]
	\centering
	\begin{subfigure}[b]{0.3\linewidth}
		\includegraphics[width=\linewidth]{./chapters/01.intro/mk2/psf.png}
		\caption{Point Spread Function.}
		\label{results:points:tclean}
	\end{subfigure}
	\begin{subfigure}[b]{0.3\linewidth}
		\includegraphics[width=\linewidth]{./chapters/01.intro/mk2/dirty.png}
		\caption{Dirty image}
		\label{results:points:tclean}
	\end{subfigure}
	\begin{subfigure}[b]{0.3\linewidth}
		\includegraphics[width=\linewidth]{./chapters/01.intro/mk2/clean.png}
		\caption{Deconvolved image.}
		\label{results:points:tclean}
	\end{subfigure}
	
	
	\caption{Image reconstruction of two simulated point sources.}
	\label{results:points}
\end{figure}
Find the fainter sources in later iterations
Because we can only estimate the psf.



\subsection{Distributing the Major and Minor Cycles}
Difficulty in separation
Each Pixel depends on all Visibilities, and a single Visibility depends on all pixels.
Doing work several times

\subsubsection{Compressed Sensing and the evolution of Priors}
Positivity constraint.
Contains two classes of objects: Point sources, which are essentially stars, and extended emissions, which span over several pixels.


\subsection{The Major Cycle Architecture}
Major cycle how to reconstruct the image with deconvolution
In an efficient manner

$V()$ problems of non-uniform sampling, and the 3 dimensions. keep us from using the Fast Fourier Transform.
We first interpolate on a regularly spaced grid, in the "Gridder".
Use the FFT. For large numbers of Visibilities, this is faster. than inverting equation directly \eqref{intro:inverseproblem}.
And now we do a deconvolution in image space

So we have three basic components, Gridder, FFT and Deconvolution algorithms.
The Major Cycle Architecture makes this a cycle.
Shown in figure \ref{intro:major}.



Why the cycle is necessary



\subsubsection{Minor Cycle}


